<!doctype html><html lang="pt-BR" dir="ltr"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Entendendo Flux</title><meta name="description" content="Web development, front end stuff, tutorials for beginners and more by Rafaell Lycan! "><meta name="google-site-verification" content="epFgX0s_0RM3CdjwFcsewfXzPov2g8s9ZBOLyaIUH-o"/><meta name="robots" content="index, follow"><meta name="HandheldFriendly" content="True" /><meta name="MobileOptimized" content="320" /><meta name="mobile-web-app-capable" content="yes"><link rel="canonical" href="http://localhost:4000/2015/entendendo-flux/"><link rel="alternate" type="application/rss+xml" title="Hi there, I'm Rafaell" href="http://feeds.feedburner.com/MikeFowler" /><link rel="shortcut icon" href="/assets/img/icons/favicon.ico" type="image/x-icon" /><link rel="author" href="https://plus.google.com/+https://plus.google.com/+RafaellLycan?rel=author"><link rel='dns-prefetch' href='//ajax.googleapis.com' /><link rel='dns-prefetch' href='//fonts.googleapis.com' /><link rel='dns-prefetch' href='//use.fontawesome.com' /><link rel='dns-prefetch' href='//s.gravatar.com' /><link rel='dns-prefetch' href='//s2.getsmartlook.com'><link rel='dns-prefetch' href='//rec.getsmartlook.com'><link rel='preconnect' href='//fonts.googleapis.com' crossorigin /><link rel='preconnect' href='//fonts.gstatic.com' crossorigin><link rel='preconnect' href='//s2.getsmartlook.com' crossorigin><link rel='preconnect' href='//rec.getsmartlook.com' crossorigin> <meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="@RafaellLycan" /><meta name="twitter:title" content="Entendendo Flux" /><meta name="twitter:description" content="Web development, front end stuff, tutorials for beginners and more by Rafaell Lycan! " /><meta property="twitter:image:src" content="http://localhost:4000assets/img/posts/entendendo-flux.jpg"> <meta property="og:title" content="Entendendo Flux"><meta property="og:url" content="http://localhost:4000/2015/entendendo-flux/"><meta property="og:description" content="Web development, front end stuff, tutorials for beginners and more by Rafaell Lycan! "><meta property="og:image" content="http://localhost:4000assets/img/posts/entendendo-flux.jpg"><meta property="og:type" content="article"><meta property="og:site_name" content="Hi there, I'm Rafaell"><link rel="manifest" href="/manifest.json"><link rel="apple-touch-icon" href="/assets/img/icon-96x96.png"><link rel="icon" sizes="192x192" href="/assets/img/icon-192x192.png"><link rel="shortcut icon" href="/assets/img/icon-192x192.png"><style> @charset "UTF-8"; /** Variables */ /** Colors */ /* * It returns the current percent of a context on a reference using pixels * Thanks Ethan Marcotte */ /* * It returns flexible value using 'target / context' formula. * Returns 'rem' as format. */ /* Breakpoint mixin */ /* * It create the current percent of a context on a reference using pixels * Thanks Ethan Marcotte */ /*! normalize.css v5.0.0 | MIT License | github.com/necolas/normalize.css */ /* Document ========================================================================== */ /** 1. Change the default font family in all browsers (opinionated). 2. Correct the line height in all browsers. 3. Prevent adjustments of font size after orientation changes in IE on Windows Phone and in iOS. */ html { font-family: sans-serif; /* 1 */ line-height: 1.15; /* 2 */ -ms-text-size-adjust: 100%; /* 3 */ -webkit-text-size-adjust: 100%; /* 3 */ } /* Sections ========================================================================== */ /** Remove the margin in all browsers (opinionated). */ body { margin: 0; } /** Add the correct display in IE 9-. */ article, aside, footer, header, nav, section { display: block; } /** Correct the font size and margin on `h1` elements within `section` and `article` contexts in Chrome, Firefox, and Safari. */ h1, .h1 { font-size: 2em; margin: 0.67em 0; } /* Grouping content ========================================================================== */ /** Add the correct display in IE 9-. 1. Add the correct display in IE. */ figcaption, figure, main { /* 1 */ display: block; } /** Add the correct margin in IE 8. */ figure { margin: 1em 40px; } /** 1. Add the correct box sizing in Firefox. 2. Show the overflow in Edge and IE. */ hr { box-sizing: content-box; /* 1 */ height: 0; /* 1 */ overflow: visible; /* 2 */ } /** 1. Correct the inheritance and scaling of font size in all browsers. 2. Correct the odd `em` font sizing in all browsers. */ pre { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */ } /* Text-level semantics ========================================================================== */ /** 1. Remove the gray background on active links in IE 10. 2. Remove gaps in links underline in iOS 8+ and Safari 8+. */ a { background-color: transparent; /* 1 */ -webkit-text-decoration-skip: objects; /* 2 */ } /** Remove the outline on focused links when they are also active or hovered in all browsers (opinionated). */ a:active, a:hover { outline-width: 0; } /** 1. Remove the bottom border in Firefox 39-. 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari. */ abbr[title] { border-bottom: none; /* 1 */ text-decoration: underline; /* 2 */ text-decoration: underline dotted; /* 2 */ } /** Prevent the duplicate application of `bolder` by the next rule in Safari 6. */ b, strong { font-weight: inherit; } /** Add the correct font weight in Chrome, Edge, and Safari. */ b, strong { font-weight: bolder; } /** 1. Correct the inheritance and scaling of font size in all browsers. 2. Correct the odd `em` font sizing in all browsers. */ code, kbd, samp { font-family: monospace, monospace; /* 1 */ font-size: 1em; /* 2 */ } /** Add the correct font style in Android 4.3-. */ dfn { font-style: italic; } /** Add the correct background and color in IE 9-. */ mark { background-color: #ff0; color: #000; } /** Add the correct font size in all browsers. */ small { font-size: 80%; } /** Prevent `sub` and `sup` elements from affecting the line height in all browsers. */ sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; } sub { bottom: -0.25em; } sup { top: -0.5em; } /* Embedded content ========================================================================== */ /** Add the correct display in IE 9-. */ audio, video { display: inline-block; } /** Add the correct display in iOS 4-7. */ audio:not([controls]) { display: none; height: 0; } /** Remove the border on images inside links in IE 10-. */ img { border-style: none; } /** Hide the overflow in IE. */ svg:not(:root) { overflow: hidden; } /* Forms ========================================================================== */ /** 1. Change the font styles in all browsers (opinionated). 2. Remove the margin in Firefox and Safari. */ button, input, optgroup, select, textarea { font-family: sans-serif; /* 1 */ font-size: 100%; /* 1 */ line-height: 1.15; /* 1 */ margin: 0; /* 2 */ } /** Show the overflow in IE. 1. Show the overflow in Edge. */ button, input { /* 1 */ overflow: visible; } /** Remove the inheritance of text transform in Edge, Firefox, and IE. 1. Remove the inheritance of text transform in Firefox. */ button, select { /* 1 */ text-transform: none; } /** 1. Prevent a WebKit bug where (2) destroys native `audio` and `video` controls in Android 4. 2. Correct the inability to style clickable types in iOS and Safari. */ button, html [type="button"], [type="reset"], [type="submit"] { -webkit-appearance: button; /* 2 */ } /** Remove the inner border and padding in Firefox. */ button::-moz-focus-inner, [type="button"]::-moz-focus-inner, [type="reset"]::-moz-focus-inner, [type="submit"]::-moz-focus-inner { border-style: none; padding: 0; } /** Restore the focus styles unset by the previous rule. */ button:-moz-focusring, [type="button"]:-moz-focusring, [type="reset"]:-moz-focusring, [type="submit"]:-moz-focusring { outline: 1px dotted ButtonText; } /** Change the border, margin, and padding in all browsers (opinionated). */ fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; } /** 1. Correct the text wrapping in Edge and IE. 2. Correct the color inheritance from `fieldset` elements in IE. 3. Remove the padding so developers are not caught out when they zero out `fieldset` elements in all browsers. */ legend { box-sizing: border-box; /* 1 */ color: inherit; /* 2 */ display: table; /* 1 */ max-width: 100%; /* 1 */ padding: 0; /* 3 */ white-space: normal; /* 1 */ } /** 1. Add the correct display in IE 9-. 2. Add the correct vertical alignment in Chrome, Firefox, and Opera. */ progress { display: inline-block; /* 1 */ vertical-align: baseline; /* 2 */ } /** Remove the default vertical scrollbar in IE. */ textarea { overflow: auto; } /** 1. Add the correct box sizing in IE 10-. 2. Remove the padding in IE 10-. */ [type="checkbox"], [type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ } /** Correct the cursor style of increment and decrement buttons in Chrome. */ [type="number"]::-webkit-inner-spin-button, [type="number"]::-webkit-outer-spin-button { height: auto; } /** 1. Correct the odd appearance in Chrome and Safari. 2. Correct the outline style in Safari. */ [type="search"] { -webkit-appearance: textfield; /* 1 */ outline-offset: -2px; /* 2 */ } /** Remove the inner padding and cancel buttons in Chrome and Safari on macOS. */ [type="search"]::-webkit-search-cancel-button, [type="search"]::-webkit-search-decoration { -webkit-appearance: none; } /** 1. Correct the inability to style clickable types in iOS and Safari. 2. Change font properties to `inherit` in Safari. */ ::-webkit-file-upload-button { -webkit-appearance: button; /* 1 */ font: inherit; /* 2 */ } /* Interactive ========================================================================== */ /* Add the correct display in IE 9-. 1. Add the correct display in Edge, IE, and Firefox. */ details, menu { display: block; } /* Add the correct display in all browsers. */ summary { display: list-item; } /* Scripting ========================================================================== */ /** Add the correct display in IE 9-. */ canvas { display: inline-block; } /** Add the correct display in IE. */ template { display: none; } /* Hidden ========================================================================== */ /** Add the correct display in IE 10-. */ [hidden] { display: none; } /** Basic styling */ *, *:before, *:after { box-sizing: border-box; } body { font: 1rem/1.8rem "Merriweather", "PT Serif", Georgia, Cambria, "Times New Roman", Times, serif; letter-spacing: 0.01rem; color: #4f5a63; background: #fff; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; } /** Images */ img { max-width: 100%; vertical-align: middle; border-radius: 2px; } /** Figures */ figure { width: 100%; margin: 0 auto; position: relative; clear: both; outline: 0; box-sizing: border-box; user-select: auto; z-index: 100; } figure > img { display: block; } figcaption { position: relative; width: 100%; left: 0; top: 0; color: rgba(79, 90, 99, 0.6); outline: 0; text-align: center; font-size: 14px; margin: 10px auto 0; } /** Headings */ h1, .h1, h2, .h2, h3, .h3, h4, .h4, h5, h6 { font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; line-height: 1.2em; font-weight: 700; } h1, .h1 { font-size: 3rem; letter-spacing: -2px; } h2, .h2 { font-size: 2.25rem; margin-top: 3rem; letter-spacing: -1px; } h3, .h3 { font-size: 1.875rem; } h4, .h4 { font-size: 1.5rem; } @media only screen and (max-width: 768px) { h1, .h1 { font-size: 2.8rem; } h2, .h2 { font-size: 2.2rem; } } @media only screen and (max-width: 480px) { h1, .h1 { font-size: 1.75rem; } h2, .h2 { font-size: 1.5rem; } h3, .h3 { font-size: 1.3rem; } h4, .h4 { font-size: 1.125rem; } } /** Paragraphs */ p { margin: 0 0 1.875rem; } /** Blockquotes */ blockquote { position: relative; margin: 3.125rem 0; padding: 0 2.5em; font-style: italic; font-size: 1.25rem; color: rgba(79, 90, 99, 0.6); letter-spacing: -.01rem; } blockquote:after, blockquote:before { position: absolute; font-size: 4em; color: rgba(0, 0, 0, 0.6); z-index: -1; font-family: 'Droid Serif', georgia, serif; } blockquote:after { content: "”"; right: 0px; } blockquote:before { content: "“"; left: 0px; } blockquote > :last-child { margin-bottom: 0; } /** Horizontal Reference */ hr { box-sizing: content-box; height: 0; display: block; border: 0; text-align: center; margin-top: 50px; margin-bottom: 50px; } hr:before { content: '...'; display: inline-block; margin-left: .6em; color: rgba(79, 90, 99, 0.4); position: relative; top: -30px; font-size: 1.8rem; letter-spacing: .6em; } @media only screen and (max-width: 768px) { hr { margin-top: 30px; margin-bottom: 30px; font-size: 1.25rem; line-height: 1.4; } } /** Code formatting */ pre, code { font-size: 1em; border-radius: 2px; } code { font-family: "Fira Mono", "monaco", "Consolas", "Lucida Console", monospace; font-size: 1rem; letter-spacing: -0.3px; padding: 1px 5px; white-space: normal; } :not(pre) > code { background: #f5f5f5; margin-right: 0.05em; margin-left: 0.05em; padding-right: 5px; padding-left: 5px; white-space: nowrap; } pre { background: #f5f5f5; line-height: 1.35; overflow-x: auto; margin: 1.875rem 0; white-space: pre; word-wrap: normal; -webkit-overflow-scrolling: touch; } pre > code { border-radius: 2px; color: #3d3e44; display: block; outline: none; overflow-x: auto; padding: 1rem; white-space: inherit; } /** Clearfix */ .clearfix:after { content: ""; display: table; clear: both; } /** Hidden */ .hidden { visibility: hidden; display: none; } /** Default list */ .default-list { list-style-type: none; margin: 0; padding: 0; } /** Image rounded */ .img-rounded { border-radius: 50%; } /** Center */ .center { margin-left: auto; margin-right: auto; } .text-center { text-align: center !important; } .text-light { font-weight: normal; } .text-base-color { color: #0074d9; } /** Links */ a { color: #0074d9; text-decoration: none; transition: all 300ms ease-in-out; } a:hover { color: #0059a6; } a:active, a:hover { text-decoration: underline; outline: 0; } .animate { animation: fade-in-down 600ms; animation-delay: 200ms; } @-webkit-keyframes fade-in-down { 0% { opacity: 0; transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(0); } } @-moz-keyframes fade-in-down { 0% { opacity: 0; transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(0); } } @-ms-keyframes fade-in-down { 0% { opacity: 0; transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(0); } } @-o-keyframes fade-in-down { 0% { opacity: 0; transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(0); } } @keyframes fade-in-down { 0% { opacity: 0; transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(0); } } @-webkit-keyframes fade { 0% { opacity: 0; } 60% { opacity: 0; } 100% { opacity: 1; } } @-moz-keyframes fade { 0% { opacity: 0; } 60% { opacity: 0; } 100% { opacity: 1; } } @-ms-keyframes fade { 0% { opacity: 0; } 60% { opacity: 0; } 100% { opacity: 1; } } @-o-keyframes fade { 0% { opacity: 0; } 60% { opacity: 0; } 100% { opacity: 1; } } @keyframes fade { 0% { opacity: 0; } 60% { opacity: 0; } 100% { opacity: 1; } } .header { width: 100%; margin-bottom: 3.75rem; } .header .author { margin: 0 auto; max-width: 45rem; padding-left: 0; padding-right: 0; border: none; animation: fade 600ms ease; } .header img { min-width: 120px; } .header p { color: inherit; } @media only screen and (max-width: 30rem) { .header p { display: none; } } .nav { position: relative; width: 100%; text-align: center; background-color: #1d2637; font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; } .nav__brand { font-weight: 700; } @media only screen and (min-width: 48rem) { .nav__brand { position: absolute; top: 0; left: 0; } } @media only screen and (min-width: 48rem) { .nav__github { position: absolute; top: 0; right: 0; } } .nav__list { max-width: 45rem; margin: 0 auto; padding: 0; list-style: none; overflow: hidden; animation: fade 600ms ease; } .nav__item { float: left; width: 33.33%; } .nav a { display: block; padding: 0.625rem 1.875rem; font-size: 13px; color: #E2E6E7; text-decoration: none; text-transform: uppercase; letter-spacing: 1.2px; transition: all 300ms ease-in-out; } .nav a:hover { color: #0d8eff; } .nav svg { vertical-align: bottom; width: 32px; height: 32px; fill: #fff; } .main-nav { position: relative; padding: 35px 40px; margin: 0 0 30px 0; } .main-nav.overlay { position: absolute; top: 0; left: 0; right: 0; height: 70px; border: none; } .split-layout__sidebar { position: relative; display: flex; padding: 1.875rem; background: #1d2637; background: url("../svgs/bg-triangles-black.svg"); font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; color: white; text-align: center; flex-direction: column; align-items: center; justify-content: center; } @media only screen and (min-width: 48rem) { .split-layout__sidebar { position: fixed; width: 40%; height: 100%; left: 0; } } @media only screen and (min-width: 60rem) { .split-layout__sidebar { width: 30%; } } .split-layout__avatar { max-width: 120px; } @media only screen and (max-width: 30rem) { .split-layout__avatar { display: none; } } .split-layout__title { font-size: 1.875rem; font-weight: 300; } .split-layout__subtitle { font-size: 0.875rem; margin-top: 0; text-transform: uppercase; opacity: .4; } @media only screen and (max-width: 30rem) { .split-layout__subtitle { padding-bottom: 2rem; } } .split-layout__description { padding: 1.875rem 0 0; } @media only screen and (max-width: 30rem) { .split-layout__description { display: none; } } .split-layout__content { padding-top: 1.875rem; padding-bottom: 1.875rem; } @media only screen and (min-width: 48rem) { .split-layout__content { margin-left: 40%; width: auto; max-width: 100%; } } @media only screen and (min-width: 60rem) { .split-layout__content { margin-left: 30%; } } .split-layout .nav { position: absolute; bottom: 0; } .split-layout .nav__brand, .split-layout .nav__github { display: none; } .split-layout .section-title { display: none; } .split-layout .post-list:before, .split-layout .post-list:after { display: none; }</style><link rel="stylesheet" href="/assets/css/main.css?1493084291212194000"><body> <main class="wrapper"><nav class="nav" role="navigation" itemtype="http://schema.org/SiteNavigationElement" itemscope> <a class="nav__brand" href="http://localhost:4000" title="Hi there, I'm Rafaell"> Rafaell Lycan </a><ul class="nav__list"><li class="nav__item"> <a href="/articles" class="nav__link" itemprop="url">Articles</a><li class="nav__item"> <a href="/projects/" class="nav__link" itemprop="url">Projects</a><li class="nav__item"> <a href="/about/" class="nav__link" itemprop="url">About</a></ul><a class="nav__github" href="https://github.com/rafaell-lycan" title="GitHub" target="github_profile"> <svg viewBox="0 0 512 512"><path d="M256 70.7c-102.6 0-185.9 83.2-185.9 185.9 0 82.1 53.3 151.8 127.1 176.4 9.3 1.7 12.3-4 12.3-8.9V389.4c-51.7 11.3-62.5-21.9-62.5-21.9 -8.4-21.5-20.6-27.2-20.6-27.2 -16.9-11.5 1.3-11.3 1.3-11.3 18.7 1.3 28.5 19.2 28.5 19.2 16.6 28.4 43.5 20.2 54.1 15.4 1.7-12 6.5-20.2 11.8-24.9 -41.3-4.7-84.7-20.6-84.7-91.9 0-20.3 7.3-36.9 19.2-49.9 -1.9-4.7-8.3-23.6 1.8-49.2 0 0 15.6-5 51.1 19.1 14.8-4.1 30.7-6.2 46.5-6.3 15.8 0.1 31.7 2.1 46.6 6.3 35.5-24 51.1-19.1 51.1-19.1 10.1 25.6 3.8 44.5 1.8 49.2 11.9 13 19.1 29.6 19.1 49.9 0 71.4-43.5 87.1-84.9 91.7 6.7 5.8 12.8 17.1 12.8 34.4 0 24.9 0 44.9 0 51 0 4.9 3 10.7 12.4 8.9 73.8-24.6 127-94.3 127-176.4C441.9 153.9 358.6 70.7 256 70.7z"> </path> </svg> </a></nav><article class="post single" itemscope itemtype="http://schema.org/BlogPosting"><header class="post__header container"><figure class="post__image"> <img src="/assets/img/posts/entendendo-flux.jpg" alt="Entendendo Flux" itemprop="thumbnailUrl"></figure><h1 class="post__title" itemprop="name headline"> Entendendo Flux</h1><div class="post__meta"> <time datetime="2015-11-28T00:00:00+01:00" itemprop="datePublished"> Nov 28, 2015 </time> <span class="section-spacing"> 5370 words </span> <span> 29 minutes read </span><ul class="meta-tag__list"><li class="meta-tag__item"> <a href="/tags/#react">react</a><li class="meta-tag__item"> <a href="/tags/#javascript">javascript</a></ul></div><div class="post__meta__divider"></div></header><section class="post__content container"><p>No <a href="/2015/comecando-com-react/">post anterior</a>, dei uma breve introdução sobre <a href="https://facebook.github.io/react/">React.js</a>, mas chega a hora de deixar a brincadeira mais interessante ;)<p>Vamos falar sobre <a href="https://facebook.github.io/flux/">Flux</a>, um <strong>padrão de arquitetura</strong> criado/inventado pelo Facebook para lidar com um problema na construção de aplicações front-end baseadas em componentes. Sim, isso é meio confuso (e muito) a primeira vista, mas vamos a algumas explicações.<p>Você pode ler toda a parte técnica a seguir<del>(aka blablabla)</del>, ou ir direto para a <a href="#estruturando-nossa-aplicao">parte do código</a>.<h2 id="o-que-é">O que é?</h2><p>Atualmente está surgindo um novo paradigma no mundo de desenvolvimento de web apps. Esses aplicativos são <strong>quebrados</strong> em <strong>componentes reutilizáveis</strong> e <strong>combináveis/agregáveis</strong> e como consequência desse conceito é que os aplicativos seguem hierarquias baseadas em componentes. A grande vantagem de se utilizar componentes é que eles são desacoplados e isolados, o que não só facilita a manutenção, mas também pode impactar positivamente na sua produtividade ou a do seu time.<p>Para aqueles que estão acostumados com o <strong>data-binding</strong> convencional como eu, vão sem dúvidas ter <strong>“problemas”</strong> com o fluxo de dados nesse padrão de arquitetura.<p>Quando os desenvolvedores do Faceboook começaram a utilizar <strong>React</strong> dentro de sua plataforma, provavelmente sofreram com esses mesmos problemas e acabaram por definir esse <strong>novo padrão de arquitetura</strong> utilizando um método de <strong>transporte de dados unidirecional</strong>.<p>Porem, <strong>Flux</strong> esta mais para um novo <strong>conjunto de padrões</strong> do que um framework, e você pode utilizar em seus projetos sem ter que escrever/reescrever muito código.<h2 id="conceitos-arquitetônicos">Conceitos arquitetônicos</h2><p>Não vamos pensar em <strong>React</strong> por hora, porque agora que começa a parte legal, já que Flux é um pattern que não deve ser confundido com <em>MVC</em>, pois os conceitos que são necessários para entender o funcionamento das coisas é um paradigma diferente do que estamos acostumados:<h4 id="actions">Actions</h4><p>São os métodos para auxiliar o envio de informações ao <em>dispatcher</em>.<h4 id="dispatcher">Dispatcher</h4><p>É o <strong>ponto central da arquitetura</strong>, responsável por gerenciar/transmitir todo o fluxo de dados para todos os que devem receber aquela informação.<p>O Dispatcher é um <a href="https://en.wikipedia.org/wiki/Singleton_pattern">Singleton</a>, porem foi baseado no padrão <a href="https://en.wikipedia.org/wiki/Publish%E2%80%93subscribe_pattern">Publish Subscribe</a> e é um ponto de <strong>registro de callbacks</strong> para as <em>stores</em>. Cada <em>store</em> se registra e fornece um callback, e quando o <em>dispatcher</em> responder a uma ação, todas as <em>stores</em> registradas recebem os dados fornecidos pela ação.<p><strong>Utilizamos apenas um <em>dispatcher</em></strong> na aplicação justamente pelo fato dele ser o pilar da aplicação, logo <strong>sua aplicação deve ter apenas um único <em>dispatcher</em>.</strong><h4 id="stores">Stores</h4><p>É o lugar onde fica armazenada toda a lógica e o estado de sua aplicação e a implementação dos callbacks registrados para o <em>dispatcher</em>.<p><em>Stores</em> tem o papel pouco semelhante a um <em>model</em> no <strong>MVC</strong> tradicional, mas além disso elas gerenciam o <strong>estado</strong> de muitos objetos e não instâncias de um único objeto.<h4 id="views">Views</h4><p>São os componentes em React que trazem os estados das <em>stores</em> e passam para os componentes filhos através de suas <strong>“props”</strong>, onde temos um ou mais componentes <strong>root</strong> que escutam eventos de suas próprias <em>stores</em>. Podemos chamar isso de uma <strong>view-controller</strong> ainda que um pouco diferente de <em>controller</em> no modelo <em>MVC</em>, já que uma vez que obtem os dados das <em>stores</em>, atualiza seus componentes dependentes seguindo a estrutura <strong>top-down</strong>, podendo assim controlar qualquer parte significativa da página.<h2 id="flux--mvc">Flux !== MVC</h2><p>Como disse anteriormente, Flux não deve ser confundido com <em>MVC</em>, pois suas actions são acionadas diretamente de suas respectivas <em>stores</em> através do <em>dispatcher</em>. Mas para isso não ficar uma completa bagunça, imagine que <em>stores</em> são proximas a camada <em>model</em>, mas é muito complicado comparar a camada <em>view</em> pois ela é também o próprio controller de uma aplicação Flux.<h2 id="fluxo">Fluxo</h2><p>Já que ele não segue o modelo <em>MVC</em>, o flow também é diferente por ser unidirecional seguindo: <br /> <strong>Actions -&gt; Dispatcher -&gt; Stores -&gt; React Views.</strong><p><img src="http://i.stack.imgur.com/mpqFt.png" alt="Flux Flow" /><p>Sempre será esse o fluxo da sua aplicação, caso um componente React (View-Controller) realizar alguma ação, uma nova action será executada enviando informações ao <em>dispatcher</em> que irá atualizar as <em>stores</em> registradas que atualizará todas as views que precisarem ser afetadas.<h2 id="estruturando-nossa-aplicação">Estruturando nossa aplicação</h2><p>Nossa aplicação será um simples <strong>Shopping Cart</strong>, onde temos duas principais áreas, sendo a <strong>vitrine</strong> de produtos, e nosso <strong>carrinho</strong> em sí.<p>Você pode dar uma olhada neste <a href="https://facebook.github.io/flux/docs/todo-list.html">Tutorial</a> oficial do Facebook fazendo um Todo List.<p>Como eu acho que tenho bom gosto, nossa loja irá vender cervejas, porque apreciar cervejas é vida &lt;3<figure class="highlight"><pre><code class="language-html" data-lang="html">  <span class="c">&lt;!-- Basic flux structure --&gt;</span>
  - /js
  ---- /actions
  -------- CartActions.js
  ---- /components
  ---- /constants
  -------- CartConstants.js
  ---- /dispatcher
  -------- AppDispatcher.js
  ---- /stores
  -------- CartStore.js
  -------- ProductsStore.js
  ---- /utils
  -------- Products.js
  ---- app.js
  - index.html
  - package.json</code></pre></figure><p>Feito, vamos atualizar nosso <code class="highlighter-rouge">package.json</code> com os seguintes modulos:<ul><li>Browserify<li>Reactify<li>React<li>Flux</ul><figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"react-flux"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simple Shopping Cart using React and Flux"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Rafaell Lycan"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"main"</span><span class="p">:</span><span class="w"> </span><span class="s2">"js/app.js"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"dependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"flux"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.1.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"react"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.14.2"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"devDependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"browserify"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^12.0.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"reactify"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.1.1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"watchify"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.6.1"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"watchify -o js/bundle.js -v -d ."</span><span class="p">,</span><span class="w">
    </span><span class="nt">"build"</span><span class="p">:</span><span class="w"> </span><span class="s2">"browserify . -cm &gt; js/bundle.min.js"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"browserify"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"transform"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"reactify"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure><h2 id="html">HTML</h2><p>Sim, utilizei o <a href="http://getbootstrap.com/">Bootstrap</a> porque não estava com saco pra fazer algo do zero, e não estou nem ai se as classes dele não fazem o menor sentido.<p>Mas por favor, adicione também <a href="https://github.com/rafaell-lycan/estudos-react/blob/master/shopping-cart/css/style.css">este arquivo CSS</a>. Sua loja vai ficar mais <em>cool</em>. É sério, adiciona!<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title&gt;</span>React Flux - Shopping Cart<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"css/style.css"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
  <span class="nt">&lt;main</span> <span class="na">id=</span><span class="s">"main"</span><span class="nt">&gt;&lt;/main&gt;</span>

  <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/bundle.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure><h2 id="mock">Mock</h2><p>Como não temos um servidor para solicitar os produtos com chamadas AJAX, vamos criar <a href="https://en.wikipedia.org/wiki/Mock_object">objeto mock</a> de retorno com alguns produtos.<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="c1">// Load Mock Product Data Into localStorage</span>
  <span class="na">load</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">id</span> <span class="p">:</span> <span class="s1">'00001'</span><span class="p">,</span>
        <span class="na">sku</span><span class="p">:</span> <span class="mi">123456</span><span class="p">,</span>
        <span class="na">name</span><span class="p">:</span> <span class="s1">'Brooklyn Lager'</span><span class="p">,</span>
        <span class="na">image</span><span class="p">:</span> <span class="s1">'http://images.meredith.com/rrmag/images/2012/05/ss_BK-Lager.jpg'</span><span class="p">,</span>
        <span class="na">price</span><span class="p">:</span> <span class="mf">10.99</span><span class="p">,</span>
        <span class="na">inventory</span><span class="p">:</span> <span class="mi">6</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span> <span class="p">:</span> <span class="s1">'00002'</span><span class="p">,</span>
        <span class="na">sku</span><span class="p">:</span> <span class="mi">123234</span><span class="p">,</span>
        <span class="na">name</span><span class="p">:</span> <span class="s1">'Abita Purple Haze'</span><span class="p">,</span>
        <span class="na">image</span><span class="p">:</span> <span class="s1">'http://images.meredith.com/rrmag/images/2012/05/ss_Abita-Purple-Haze.jpg'</span><span class="p">,</span>
        <span class="na">price</span><span class="p">:</span> <span class="mf">7.99</span><span class="p">,</span>
        <span class="na">inventory</span><span class="p">:</span> <span class="mi">2</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span> <span class="p">:</span> <span class="s1">'00003'</span><span class="p">,</span>
        <span class="na">sku</span><span class="p">:</span> <span class="mi">1236789</span><span class="p">,</span>
        <span class="na">name</span><span class="p">:</span> <span class="s1">'Miller High Life'</span><span class="p">,</span>
        <span class="na">image</span><span class="p">:</span> <span class="s1">'http://images.meredith.com/rrmag/images/2012/05/ss_Miller.jpg'</span><span class="p">,</span>
        <span class="na">price</span><span class="p">:</span> <span class="mf">4.89</span><span class="p">,</span>
        <span class="na">inventory</span><span class="p">:</span> <span class="mi">12</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span> <span class="p">:</span> <span class="s1">'00004'</span><span class="p">,</span>
        <span class="na">sku</span><span class="p">:</span> <span class="mi">2346430</span><span class="p">,</span>
        <span class="na">name</span><span class="p">:</span> <span class="s1">'Samuel Adams Boston Lager'</span><span class="p">,</span>
        <span class="na">image</span><span class="p">:</span> <span class="s1">'http://images.meredith.com/rrmag/images/2012/05/ss_Sam-Adams.jpg'</span><span class="p">,</span>
        <span class="na">price</span><span class="p">:</span> <span class="mf">6.99</span><span class="p">,</span>
        <span class="na">inventory</span><span class="p">:</span> <span class="mi">4</span>
      <span class="p">},</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">};</span></code></pre></figure><p>Ridiculo não?<p>Pense que em <strong>/utils</strong> você ira jogar toda e qualquer parte do seu sistema que não faça parte da estrutura flux.<p>Claro que você pode utilizar outros nomes, mas normalmente <strong>utils</strong> e <strong>helpers</strong> são mais genéricos <del>as vezes até de mais</del>.<h2 id="actions--constants">Actions &amp; Constants</h2><p>Actions são coleções de métodos que são chamadas pelas nossas <strong>“views”</strong> que enviam ações para o <em>dispatcher</em> contendo <strong>payloads</strong> que serão entregues as <em>stores</em>.<p>Um ponto interessante é que o Facebook as usa em conjunto com as <em>constantes</em> da aplicação, passando via payload o <code class="highlighter-rouge">actionType</code> usando assim as <em>constants</em>.<p>De uma olhada no arquivo <code class="highlighter-rouge">CartConstants.js</code>:<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">CART_ADD</span> <span class="p">:</span> <span class="s2">"CART_ADD"</span><span class="p">,</span>
  <span class="na">CART_REMOVE</span> <span class="p">:</span> <span class="s2">"CART_REMOVE"</span><span class="p">,</span>
  <span class="na">CART_VISIBLE</span> <span class="p">:</span> <span class="s2">"CART_VISIBLE"</span><span class="p">,</span>
  <span class="na">LOAD_PRODUCTS</span> <span class="p">:</span> <span class="s2">"LOAD_PRODUCTS"</span>
<span class="p">};</span></code></pre></figure><p>Uma outra abordagem para criar nossas <em>constants</em> é utilizando a lib <a href="https://www.npmjs.com/package/keymirror">keyMirror</a>, que simplesmente duplica o valor da chave para uma string, sem a necessidade de escrever novamente.<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">let</span> <span class="nx">keyMirror</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'keyMirror'</span><span class="p">);</span>
<span class="c1">// Versões anteriores do React contem o pacote em</span>
<span class="c1">// 'react/lib/keyMirror'</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">keyMirror</span><span class="p">({</span>
  <span class="na">CART_ADD</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="na">CART_REMOVE</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="na">CART_VISIBLE</span> <span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
  <span class="na">LOAD_PRODUCTS</span> <span class="p">:</span> <span class="kc">null</span>
<span class="p">});</span></code></pre></figure><p>Eu não acho necessário, mas pode ser interessante para a sua aplicação.<p>Agora nosso arquivo <code class="highlighter-rouge">CartActions.js</code>:<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">let</span> <span class="nx">AppDispatcher</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../dispatcher/AppDispatcher'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">CartConstants</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../constants/CartConstants'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">CartActionsActions</span> <span class="o">=</span> <span class="p">{</span>

  <span class="c1">// Load initial products</span>
  <span class="na">loadProducts</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">handleViewAction</span><span class="p">({</span>
      <span class="na">actionType</span><span class="p">:</span> <span class="nx">CartConstants</span><span class="p">.</span><span class="nx">LOAD_PRODUCTS</span><span class="p">,</span>
      <span class="na">data</span><span class="p">:</span> <span class="nx">data</span>
    <span class="p">})</span>
  <span class="p">},</span>

  <span class="c1">// Add item to cart</span>
  <span class="na">addToCart</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">productId</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">handleViewAction</span><span class="p">({</span>
      <span class="na">actionType</span><span class="p">:</span> <span class="nx">CartConstants</span><span class="p">.</span><span class="nx">CART_ADD</span><span class="p">,</span>
      <span class="na">product</span><span class="p">:</span> <span class="nx">productId</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="c1">// Remove item from cart</span>
  <span class="nl">removeFromCart</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">productId</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">handleViewAction</span><span class="p">({</span>
      <span class="na">actionType</span><span class="p">:</span> <span class="nx">CartConstants</span><span class="p">.</span><span class="nx">CART_REMOVE</span><span class="p">,</span>
      <span class="na">product</span><span class="p">:</span> <span class="nx">productId</span>
    <span class="p">})</span>
  <span class="p">}</span>

  <span class="nl">toggleCaartVisible</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">isVisible</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">handleViewAction</span><span class="p">({</span>
      <span class="na">actionType</span><span class="p">:</span> <span class="nx">CartConstants</span><span class="p">.</span><span class="nx">CART_VISIBLE</span><span class="p">,</span>
      <span class="na">isVisible</span><span class="p">:</span> <span class="nx">isVisible</span>
    <span class="p">})</span>
  <span class="p">}</span>

<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">CartActionsActions</span><span class="p">;</span></code></pre></figure><p>Perceba que nossas <em>actions</em> são bem simples. Nós <strong>carregamos os produtos</strong>, <strong>adicionamos</strong> e <strong>removemos</strong> produtos dos carrinho e manipulamos a <strong>visibilidade</strong> do carrinho.<p>Utilizamos o método <code class="highlighter-rouge">handleViewAction</code> que iremos implementar em nosso <em>dispatcher</em> que recebe um objeto como parametro onde por default adicionamos a propriedade <code class="highlighter-rouge">actionType</code> que utiliza nossas <em>constants</em> como recurso.<h2 id="o-dispatcher">O Dispatcher</h2><p>Falamos muito sobre o <em>Dispatcher</em>, mas vamos ver na prática como utilizar esse cara.<p>O Dispatcher é o cara que gerencia basicamente todo o processo da nossa aplicação, e a grande mágica que o faz ser o ponto central são os métodos <code class="highlighter-rouge">register</code> e <code class="highlighter-rouge">dispatch</code>, que são nossos <strong>triggers</strong> de eventos a entre a ação que disparou o evento e as <em>stores</em> registradas. Ele simplesmente recebe a <strong>action</strong> e propaga para as <em>stores</em> que ira identifica-la e disparar um evento caso registrado.<p><strong><em>Meh… então é um Pub/Sub mesmo?</em></strong><p>Mais ou menos isso, já que conceito do <em>dispatcher</em> é transmitir <strong>payloads</strong> para todas as <em>stores</em> registradas e seus respectivos callbacks.<p>Nosso arquivo <code class="highlighter-rouge">AppDispatcher.js</code> vai ficar assim:<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">Dispatcher</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'flux'</span><span class="p">).</span><span class="nx">Dispatcher</span><span class="p">,</span>
    <span class="nx">AppDispatcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dispatcher</span><span class="p">();</span>

<span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">handleViewAction</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">action</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">({</span>
    <span class="na">source</span> <span class="p">:</span> <span class="s1">'VIEW_ACTION'</span><span class="p">,</span>
    <span class="na">action</span> <span class="p">:</span> <span class="nx">action</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">AppDispatcher</span><span class="p">;</span></code></pre></figure><p>Note que criei uma instancia do Dispatcher e também o método <code class="highlighter-rouge">handleViewAction</code> com a simples finalidade de abstrair entre nossas actions das <strong>Views</strong> e nossas actions vindas de uma <strong>API/Servidor</strong>.<p>O método utiliza o método <code class="highlighter-rouge">dispatch</code> que faz toda a mágica de emitir o evento contendo em nossa propriedade <code class="highlighter-rouge">action</code> o payload com a ação/action e nosso dados.<h4 id="gotchas--tricks">Gotchas / Tricks</h4><p>Sua aplicação pode depender da execução/atualização de alguma outra <em>store</em> antes de renderizar novamente um componente, etc. Isso é possível utilizando o método <code class="highlighter-rouge">waitFor</code> que me foi muito útil quando passei por isso.<p><strong>Exemplo:</strong><figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="cm">/* ProductsStore.js */</span>
<span class="kd">let</span> <span class="nx">ProductsStore</span> <span class="o">=</span> <span class="p">...</span>
<span class="nx">ProductsStore</span><span class="p">.</span><span class="nx">dispatcherIndex</span> <span class="o">=</span> <span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span> <span class="p">{});</span>

<span class="cm">/* CartStore.js */</span>
<span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">payload</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">switch</span><span class="p">(</span><span class="nx">payload</span><span class="p">.</span><span class="nx">action</span><span class="p">.</span><span class="nx">actionType</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="s1">'PURSHASE_ITEMS'</span><span class="err">:</span>
      <span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">waitFor</span><span class="p">([</span>
        <span class="nx">ProductsStore</span><span class="p">.</span><span class="nx">dispatcherIndex</span>
      <span class="p">],</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">CartStore</span><span class="p">.</span><span class="nx">checkout</span><span class="p">(</span><span class="nx">_onCartProducts</span><span class="p">);</span>
      <span class="p">});</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span></code></pre></figure><p>Quando o <em>dispatcher</em> transmitir a <em>action</em> <code class="highlighter-rouge">PURSHASE_ITEMS</code> no <code class="highlighter-rouge">CartStore</code>, antes de executar o método <code class="highlighter-rouge">checkout</code>, ele deve aguardar a execução dos eventos em <code class="highlighter-rouge">ProductsStore</code>.<h2 id="stores-1">Stores</h2><p>Falamos muito sobre <strong>stores</strong>, e agora que temos nossas actions definidas, chegou a hora de criar nossas <em>stores</em>.<p>Cada <em>Store</em> gerencia o estado de um dominio especifico da aplicação, nesse caso vamos criar nossa primeira <em>store</em> que sera responsável por gerenciar os produtos da loja, a <code class="highlighter-rouge">ProductStore.js</code>.<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">AppDispatcher</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../dispatcher/AppDispatcher'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">EventEmitter</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'events'</span><span class="p">).</span><span class="nx">EventEmitter</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">CartConstants</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../constants/CartConstants'</span><span class="p">);</span>

<span class="c1">// Initial data points</span>
<span class="kd">let</span> <span class="nx">_products</span> <span class="o">=</span> <span class="p">[];</span>

<span class="c1">// Will load products from some API</span>
<span class="kd">function</span> <span class="nx">loadProducts</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">_products</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">ProductStoreFactory</span> <span class="kr">extends</span> <span class="nx">EventEmitter</span><span class="p">{</span>

  <span class="c1">// Return Product list</span>
  <span class="nx">getProducts</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_products</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Emit Change event</span>
  <span class="nx">emitChange</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">'change'</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Add change listener</span>
  <span class="nx">addChangeListener</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Remove change listener</span>
  <span class="nx">removeChangeListener</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">removeListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
  <span class="p">}</span>

<span class="p">}</span>

<span class="kd">let</span> <span class="nx">ProductStore</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductStoreFactory</span><span class="p">();</span>

<span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">payload</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">action</span> <span class="o">=</span> <span class="nx">payload</span><span class="p">.</span><span class="nx">action</span><span class="p">;</span>

  <span class="k">switch</span> <span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">actionType</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">CartConstants</span><span class="p">.</span><span class="nx">LOAD_PRODUCTS</span><span class="err">:</span>
      <span class="nx">loadProducts</span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="nl">default</span><span class="p">:</span>
      <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">ProductStore</span><span class="p">.</span><span class="nx">emitChange</span><span class="p">();</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">ProductStore</span><span class="p">;</span></code></pre></figure><p>Utilizei a notação <code class="highlighter-rouge">class</code> do ES6 apenas para facilitar a criação da classe <code class="highlighter-rouge">ProductStoreFactory</code>, que por sua vez estende os métodos do <code class="highlighter-rouge">EventEmitter</code> onde adicionamos os métodos <code class="highlighter-rouge">emitChange</code>, <code class="highlighter-rouge">addChangeListener</code> e <code class="highlighter-rouge">removeChangeListener</code>.<p>Definimos os métodos o método privado <code class="highlighter-rouge">loadProducts</code> fora da nossa classe que adiciona a lista de produtos em nosso Array <code class="highlighter-rouge">_products</code>. Também deixamos o método <code class="highlighter-rouge">getProduct</code> exposto que nos retorna a lista de produtos.<p>Por fim, adicionamos um callback em nosso <code class="highlighter-rouge">AppDispatcher</code> através do método <strong>register</strong> que determina se o payload transmitido bate com alguma combinação em nosso bloco <code class="highlighter-rouge">switch</code> e então emitimos uma mudança em <code class="highlighter-rouge">ProductStore</code>.<p>O próximo passo é criar nosso <code class="highlighter-rouge">CartStore</code>:<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">AppDispatcher</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../dispatcher/AppDispatcher'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">EventEmitter</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'events'</span><span class="p">).</span><span class="nx">EventEmitter</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">CartConstants</span> <span class="o">=</span>  <span class="nx">require</span><span class="p">(</span><span class="s1">'../constants/CartConstants'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">_products</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">_cartVisible</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">ProductCartModel</span><span class="p">(</span><span class="nx">product</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">price</span> <span class="o">=</span> <span class="nx">product</span><span class="p">.</span><span class="nx">price</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">sku</span> <span class="o">=</span> <span class="nx">product</span><span class="p">.</span><span class="nx">sku</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">amount</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_addItem</span> <span class="p">(</span><span class="nx">product</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">_products</span><span class="p">[</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_products</span><span class="p">[</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ProductCartModel</span><span class="p">(</span><span class="nx">product</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">_products</span><span class="p">[</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">].</span><span class="nx">amount</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_removeItem</span> <span class="p">(</span><span class="nx">product</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">delete</span> <span class="nx">_products</span><span class="p">[</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">_setVisibility</span> <span class="p">(</span><span class="nx">visibility</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">_cartVisible</span> <span class="o">=</span> <span class="nx">visibility</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">CartStoreFactory</span> <span class="kr">extends</span> <span class="nx">EventEmitter</span><span class="p">{</span>

  <span class="c1">// Return cart items</span>
  <span class="nx">getCartItems</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_products</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Return amount of items in cart</span>
  <span class="nx">getCartAmount</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">_products</span><span class="p">).</span><span class="nx">length</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Return cart total cost</span>
  <span class="nx">getCartTotal</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">prod</span> <span class="k">in</span> <span class="nx">_products</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">total</span> <span class="o">+=</span> <span class="nx">_products</span><span class="p">[</span><span class="nx">prod</span><span class="p">].</span><span class="nx">price</span> <span class="o">*</span> <span class="nx">_products</span><span class="p">[</span><span class="nx">prod</span><span class="p">].</span><span class="nx">amount</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nb">parseFloat</span><span class="p">(</span><span class="nx">total</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
  <span class="p">}</span>

  <span class="c1">// Return cart visibility state</span>
  <span class="nx">getCartVisible</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">_cartVisible</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c1">// Emit Change event</span>
  <span class="nx">emitChange</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">emit</span><span class="p">(</span><span class="s1">'change'</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="c1">// Add change listener</span>
  <span class="nx">addChangeListener</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="c1">// Remove change listener</span>
  <span class="nx">removeChangeListener</span> <span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">removeListener</span><span class="p">(</span><span class="s1">'change'</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">CartStore</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">CartStoreFactory</span><span class="p">();</span>

<span class="nx">AppDispatcher</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">payload</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">action</span> <span class="o">=</span> <span class="nx">payload</span><span class="p">.</span><span class="nx">action</span><span class="p">;</span>

  <span class="k">switch</span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">actionType</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="nx">CartConstants</span><span class="p">.</span><span class="nx">CART_ADD</span><span class="err">:</span>
      <span class="nx">_addItem</span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">product</span><span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="nx">CartConstants</span><span class="p">.</span><span class="nx">CART_REMOVE</span><span class="err">:</span>
      <span class="nx">_removeItem</span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">product</span><span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="nx">CartConstants</span><span class="p">.</span><span class="nx">CART_VISIBLE</span><span class="err">:</span>
      <span class="nx">_setVisibility</span><span class="p">(</span><span class="nx">action</span><span class="p">.</span><span class="nx">isVisible</span><span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="nl">default</span><span class="p">:</span>
      <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">CartStore</span><span class="p">.</span><span class="nx">emitChange</span><span class="p">();</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">CartStore</span><span class="p">;</span></code></pre></figure><p>Basicamente o mesmo que a <em>store</em> anterior, temos nossa lista de produtos armazenada em <code class="highlighter-rouge">_products</code> que por sua vez é um objeto para facilitar a localização dos produtos através de sua <strong>‘key’</strong> e <code class="highlighter-rouge">_cartVisible</code> para definir o status do nosso cart.<p>Também adicionamos alguns métodos publicos que serão utilizados pelo <strong>View-Controller</strong> para definir o <em>state</em> da aplicação:<ul><li><code class="highlighter-rouge">getCartItems</code> : Retorna os itens em nosso carrinho;<li><code class="highlighter-rouge">getCartAmount</code> : Retorna o total de itens em nosso carrinho;<li><code class="highlighter-rouge">getCartTotal</code> : Retorna o valor total dos itens em nosso carrinho;<li><code class="highlighter-rouge">getCartVisible</code> : Retorna um boolean que irá omitir ou mostrar o carrinho em nosso layout.</ul><p>Você deve ter percebido que nessa <em>store</em> temos alguns métodos que são privados como <code class="highlighter-rouge">_addItem</code>, <code class="highlighter-rouge">_removeItem</code> e <code class="highlighter-rouge">_setVisibility</code> que serão utilizados a cada vez que um action vindo do <strong>payload</strong> bater com a condição em nosso <strong>register</strong>.<p>O legal é que em <code class="highlighter-rouge">_addItem</code>, ao invés de simplesmente jogar o produto dentro do carrinho, eu preferi fazer um mapper com a função ProductCartModel <del>poderia ter usando ES6, mas…</del> para me retornar um objeto apenas com o que realmente é necessário para o meu carrinho.<p>A cada vez que um produto é adicionado, nosso método verifica se o mesmo <strong>id</strong> encontra-se em nossa lista de produtos; Se sim, simplesmente <strong>incrementamos</strong> a quantidade; Do contrário criamos um novo produto mapeado e inserimos em nossa lista.<p>Agora que temos nossas <em>stores</em> criadas, vamos criar nossos Views e os respectivos componentes.<h2 id="view-controller">View Controller</h2><p>Apenas recaptulando que <strong>“view-controller”</strong> não tem nada haver com o padrão <em>MVC</em>, são apenas componentes que irão escutar por mudanças baseadas no <em>*estado</em> da aplicação vindas de nossas <em>stores</em>.<p>Vamos começar pelo simples, o <code class="highlighter-rouge">app.js</code>.<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'react'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">ShoppingCartApp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./components/Application'</span><span class="p">);</span>

<span class="nx">React</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">ShoppingCartApp</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'main'</span><span class="p">));</span></code></pre></figure><p>Agora que já temos um norte para seguir, nesse caso o componente <code class="highlighter-rouge">Application.js</code>, responsável por ser o <strong>root</strong> da nossa aplicação.<p>Vamos dar uma olhada:<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'react'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ProductsStore</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../stores/ProductsStore'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">CartStore</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../stores/CartStore'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ProductsComponent</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./Products'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">CartComponent</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./Cart'</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">getApplicationState</span> <span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">products</span><span class="p">:</span> <span class="nx">ProductsStore</span><span class="p">.</span><span class="nx">getProducts</span><span class="p">(),</span>
    <span class="na">cart</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">items</span><span class="p">:</span> <span class="nx">CartStore</span><span class="p">.</span><span class="nx">getCartItems</span><span class="p">(),</span>
      <span class="na">amount</span><span class="p">:</span> <span class="nx">CartStore</span><span class="p">.</span><span class="nx">getCartAmount</span><span class="p">(),</span>
      <span class="na">total</span><span class="p">:</span> <span class="nx">CartStore</span><span class="p">.</span><span class="nx">getCartTotal</span><span class="p">(),</span>
      <span class="na">isVisible</span><span class="p">:</span> <span class="nx">CartStore</span><span class="p">.</span><span class="nx">getCartVisible</span><span class="p">()</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}</span>

<span class="c1">// Create main View Controller</span>
<span class="kd">let</span> <span class="nx">Application</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="c1">// Set initial state from Stores</span>
  <span class="na">getInitialState</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">getApplicationState</span><span class="p">();</span>
  <span class="p">},</span>

  <span class="c1">// Add change listener to store</span>
  <span class="na">componentDidMount</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">ProductsStore</span><span class="p">.</span><span class="nx">addChangeListener</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_onChange</span><span class="p">);</span>
    <span class="nx">CartStore</span><span class="p">.</span><span class="nx">addChangeListener</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_onChange</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="c1">// Remove change listener from store</span>
  <span class="na">componentWillUnmount</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">ProductsStore</span><span class="p">.</span><span class="nx">removeChangeListener</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_onChange</span><span class="p">);</span>
    <span class="nx">CartStore</span><span class="p">.</span><span class="nx">removeChangeListener</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_onChange</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="c1">// Update state when store change</span>
  <span class="na">_onChange</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">getApplicationState</span><span class="p">());</span>
  <span class="p">},</span>

  <span class="na">renderCartComponent</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">CartComponent</span> <span class="nx">cart</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">cart</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">;
</span>  <span class="p">},</span>

  <span class="na">renderProductsComponent</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">ProductsComponent</span> <span class="nx">products</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">products</span><span class="p">}</span> <span class="sr">/&gt;</span><span class="err">;
</span>  <span class="p">},</span>

  <span class="c1">// Render the main component and childs, passing state via props</span>
  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"container"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h1</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"text-center"</span><span class="o">&gt;</span><span class="nx">Beer</span> <span class="nx">Shopping</span> <span class="nx">App</span><span class="o">&lt;</span><span class="sr">/h1</span><span class="err">&gt;
</span>        <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">renderCartComponent</span><span class="p">()}</span>
        <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">renderProductsComponent</span><span class="p">()}</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Application</span><span class="p">;</span></code></pre></figure><p>Sim, esse cara faz muitas coisas <del>coisa pra caralho…</del>, carrega nossas <em>stores</em>, adiciona os listeners nos eventos <code class="highlighter-rouge">componentDidMount</code> e <code class="highlighter-rouge">componentWillUnmount</code> no <strong>lifecycle</strong> do componente, renderiza os componentes <code class="highlighter-rouge">CartComponent</code> e <code class="highlighter-rouge">ProductsComponent</code> e ainda seta um estado/state inicial do componente que ira ser passado como referência para os demais componentes filhos através do método <code class="highlighter-rouge">getInitialState</code>.<p>Vejamos… cada componente, esta sendo renderizado através de uma função, isso eu descobri sendo uma boa prática ao invés de renderizar todos os <strong>N</strong> componentes direto no método <code class="highlighter-rouge">render</code> e depois simplesmente chamar executando o mesmo como por exemplo <code class="highlighter-rouge"><span class="p">{</span><span class="err">this.renderCartComponent()</span><span class="p">}</span></code>.<p>Agora vamos ao componente de produtos:<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'react'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">CartActions</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../actions/CartActions'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">ProductsMock</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../utils/Products'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">Product</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'./Product'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">Products</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="c1">// Request products from somewhere</span>
  <span class="na">_loadProducts</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">CartActions</span><span class="p">.</span><span class="nx">loadProducts</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">ProductsMock</span><span class="p">.</span><span class="nx">load</span><span class="p">()));</span>
  <span class="p">},</span>

  <span class="c1">// Load products when the component render</span>
  <span class="na">componentDidMount</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_loadProducts</span><span class="p">();</span>
  <span class="p">},</span>

  <span class="c1">// Parse our product list in Product component</span>
  <span class="na">renderProducts</span> <span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">products</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span> <span class="p">(</span><span class="nx">product</span><span class="p">,</span> <span class="nx">i</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">Product</span>
          <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span>
          <span class="nx">product</span><span class="o">=</span><span class="p">{</span><span class="nx">product</span><span class="p">}</span>
          <span class="nx">addProduct</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">addProduct</span><span class="p">}</span>
        <span class="sr">/</span><span class="err">&gt;
</span>        <span class="p">)</span>
    <span class="p">});</span>
  <span class="p">},</span>

  <span class="c1">// Add Product action</span>
  <span class="na">addProduct</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">product</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">CartActions</span><span class="p">.</span><span class="nx">addToCart</span><span class="p">(</span><span class="nx">product</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="c1">// Render product view</span>
  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"row"</span><span class="o">&gt;</span>
        <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">renderProducts</span><span class="p">()}</span>
      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Products</span><span class="p">;</span></code></pre></figure><p>O código acima esta bem auto-explicativo, mas vou dar alguns <strong>highlights</strong>:<p>Ao carregar o componente, o método <code class="highlighter-rouge">_loadProducts</code> é executado, o qual irá carregar os nossos produtos de algum lugar (nesse caso nosso Products<strong>Mock</strong>). Utilizei <code class="highlighter-rouge">setTimeout</code> apenas para garantir um processo assíncrono;<p>Renderizamos o componente <code class="highlighter-rouge">&lt;Product /&gt;</code> para cada produto que tivermos em nossa <em>store</em> utilizando <strong>Array.map()</strong> passando uma key para que cada componente seja único, o produto em sí e o método addProduct que irá fazer o <strong>trigger</strong> <code class="highlighter-rouge">addToCart</code> em nossas <strong>actions</strong> definidas anteriormente.<p>Antes de passarmos ao carrinho, vamos dar uma olhada em como ficou nosso <code class="highlighter-rouge">&lt;Product /&gt;</code>:<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'react'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">Product</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="c1">// Render product view</span>
  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s1">'col-md-3'</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">h4</span> <span class="nx">className</span><span class="o">=</span><span class="s1">'text-center'</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/h4</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">product</span><span class="p">.</span><span class="nx">image</span><span class="p">}</span> <span class="nx">alt</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span> <span class="nx">className</span><span class="o">=</span><span class="s1">'img-responsive img-thumbnail'</span> <span class="o">/&gt;</span>
        <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="na">Price</span><span class="p">:</span><span class="o">&lt;</span><span class="sr">/b&gt; {this.props.product.price} &lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="na">Quantity</span><span class="p">:</span><span class="o">&lt;</span><span class="sr">/b&gt; {this.props.product.inventory} &lt;/</span><span class="nx">p</span><span class="o">&gt;</span>

        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">className</span><span class="o">=</span><span class="s1">'btn btn-lg btn-block btn-danger'</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">addProduct</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">product</span><span class="p">)}</span><span class="o">&gt;</span><span class="nx">Add</span> <span class="nx">to</span> <span class="nx">Cart</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Product</span><span class="p">;</span></code></pre></figure><p>Esse sem dúvidas é o componente mais simples da aplicação, quase um componente <strong>burro</strong>, já que o único evento que ele tem é nosso <strong>click</strong>, que irá disparar o método <code class="highlighter-rouge">addProduct</code> passado como propriedade.<p>Enfim, vamos ao <code class="highlighter-rouge">&lt;CartComponent /&gt;</code>:<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="s1">'use strict'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'react'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">CartActions</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'../actions/CartActions'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">Cart</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>

  <span class="c1">// Control display/hide of the cart</span>
  <span class="na">toggleCartDisplay</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">e</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="nx">CartActions</span><span class="p">.</span><span class="nx">toggleCaartVisible</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">cart</span><span class="p">.</span><span class="nx">isVisible</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="c1">// Parse our cart produts in a list</span>
  <span class="na">removeProduct</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">productId</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">CartActions</span><span class="p">.</span><span class="nx">removeFromCart</span><span class="p">(</span><span class="nx">productId</span><span class="p">);</span>
  <span class="p">},</span>

  <span class="na">renderProductsList</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">products</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">cart</span><span class="p">.</span><span class="nx">items</span><span class="p">;</span>

    <span class="k">return</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">products</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">product</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">(</span>
        <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">key</span><span class="o">=</span><span class="p">{</span><span class="nx">products</span><span class="p">[</span><span class="nx">product</span><span class="p">].</span><span class="nx">id</span><span class="p">}</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">p</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"beer-name"</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">products</span><span class="p">[</span><span class="nx">product</span><span class="p">].</span><span class="nx">name</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">products</span><span class="p">[</span><span class="nx">product</span><span class="p">].</span><span class="nx">amount</span><span class="p">}</span> <span class="nx">x</span> <span class="nx">$</span> <span class="p">{</span><span class="nx">products</span><span class="p">[</span><span class="nx">product</span><span class="p">].</span><span class="nx">price</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>          <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"btn btn-danger btn-block"</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">removeProduct</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">products</span><span class="p">[</span><span class="nx">product</span><span class="p">])}</span><span class="o">&gt;</span><span class="nx">Remove</span><span class="o">&lt;</span><span class="sr">/button</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>      <span class="p">)</span>
    <span class="p">});</span>
  <span class="p">},</span>

  <span class="c1">// Render cart view</span>
  <span class="na">render</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"row cart-component"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"text-center"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"#"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"btn btn-lg btn-danger"</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">toggleCartDisplay</span><span class="p">}</span><span class="o">&gt;</span><span class="nx">Show</span> <span class="nx">Cart</span> <span class="p">({</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">cart</span><span class="p">.</span><span class="nx">amount</span><span class="p">})</span><span class="o">&lt;</span><span class="sr">/a</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">cart</span><span class="p">.</span><span class="nx">isVisible</span><span class="p">?</span> <span class="s1">'cart-container'</span> <span class="p">:</span> <span class="s1">'cart-container hidden'</span><span class="p">}</span><span class="o">&gt;</span>

          <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">"#"</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"glyphicon glyphicon-remove close-btn"</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">toggleCartDisplay</span><span class="p">}</span><span class="o">&gt;&lt;</span><span class="sr">/a</span><span class="err">&gt;
</span>
          <span class="o">&lt;</span><span class="nx">ul</span><span class="o">&gt;</span>
            <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">renderProductsList</span><span class="p">()}</span>
          <span class="o">&lt;</span><span class="sr">/ul</span><span class="err">&gt;
</span>
          <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"total"</span><span class="o">&gt;</span><span class="na">Total</span><span class="p">:</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">cart</span><span class="p">.</span><span class="nx">total</span><span class="p">}</span><span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Cart</span><span class="p">;</span></code></pre></figure><p>Também bem auto-explicativo, com pequenas diferença devido a função exercida, mas nada de mais:<ul><li><strong>toggleCartDisplay</strong> é o responsável por mostrar/esconder o carrinho em sí;<li><strong>removeProduct</strong> faz o <strong>trigger</strong> <code class="highlighter-rouge">removeFromCart</code> em nossas <strong>actions</strong>;<li><strong>renderProductsList</strong> renderiza a lista de produtos dentro do carrinho, fazendo essa gambiarra que você esta vendo, já que estamos utilizando um <strong>objeto</strong> como lista.</ul><p>E é isso, só rodar e ser feliz. LoL<h2 id="conclusão">Conclusão</h2><p>Eu deveria ter escrito este post logo na sequência, mas tive alguns imprevistos e acabei deixando-o de lado por algumas semanas.<p>Entenda que <strong>React + Flux</strong> é sem sombra de dúvidas uma <strong>combinação poderosa</strong>, mas você deve ter em mente a necessidade de utiliza-la e como aplica-la em seu projeto, <strong>se não tudo pode vira uma completa salada</strong>, nada fica claro e alguem vai <strong>ter pesadelos</strong> sempre que for manter a aplicação.<p>Atualmente venho fazendo coisas legais com <em>React</em>, inclusive peguei alguns freelas para o exterior, onde dois projetos estavam utilizando essa mesma arquitetura com outros patterns como o <a href="https://github.com/reflux/refluxjs">Reflux</a>, que tem uma leve mudança quando ao <em>Flux</em>, mas nada muito complexo.<p>Você pode <a href="https://github.com/rafaell-lycan/estudos-react/tree/master/shopping-cart">baixar este exemplo aqui</a>.</section><footer class="post__footer"><section class="share"><div class="container"><ul class="share__post-list"><li class="share__post-item" data-hint="Share on Facebook"> <a class="share__icon share__icon--facebook" href="https://facebook.com/sharer.php?u=http://localhost:4000/2015/entendendo-flux/" target="share-facebook" title="Share on Facebook"> <span class="share__text">Like</span></a> </a><li class="share__post-item" data-hint="Share on Twitter"> <a class="share__icon share__icon--twitter" href="https://twitter.com/intent/tweet?text=Entendendo Flux&url=http://localhost:4000/2015/entendendo-flux/&via=RafaellLycan&related=RafaellLycan" target="share-twitter" title="Share on Twitter"> <span class="share__text">Tweet</span></a> </a><li class="share__post-item" data-hint="Share on Google Plus"> <a class="share__icon share__icon--gplus" href="https://plus.google.com/share?url=http://localhost:4000/2015/entendendo-flux/" target="share-gplus" title="Share on Google Plus"> <span class="share__text">+1</span></a> </a></ul></div></section><section class="related container"><h3 class="related__title">References</h3><ul class="default-list"><li class="related__mention" itemprop="mentions" itemscope itemtype="https://schema.org/Thing"> <a itemprop="url" href="https://facebook.github.io/flux/docs/overview.html#content" title="Flux Docs - Overview" target="_blank"> <span itemprop="name">Flux Docs - Overview</span> </a><li class="related__mention" itemprop="mentions" itemscope itemtype="https://schema.org/Thing"> <a itemprop="url" href="http://reactjsnews.com/getting-started-with-flux/" title="Getting Started with Flux" target="_blank"> <span itemprop="name">Getting Started with Flux</span> </a><li class="related__mention" itemprop="mentions" itemscope itemtype="https://schema.org/Thing"> <a itemprop="url" href="https://facebook.github.io/flux/docs/todo-list.html" title="Flux TodoMVC Tutorial" target="_blank"> <span itemprop="name">Flux TodoMVC Tutorial</span> </a><li class="related__mention" itemprop="mentions" itemscope itemtype="https://schema.org/Thing"> <a itemprop="url" href="https://www.youtube.com/watch?v=nYkdrAPrdcw" title="Rethinking Web App Development at Facebook (Youtube)" target="_blank"> <span itemprop="name">Rethinking Web App Development at Facebook (Youtube)</span> </a></ul></section><section class="author" itemprop="author"><div class="author__content container" itemscope itemtype="http://schema.org/Person"><div class="author__pic"> <img src="http://gravatar.com/avatar/dd1c977c7a3e384a9cdae3b5ddd9b006?s=150" alt="" itemprop="image" class="img-rounded"></div><div class="author__bio"><h3 class="author__name" itemprop="name">Rafael Almeida</h3><p> A brazilian Front-end Engineer, living in Barcelona. Works with the web, loves photography and beers, and hates seafood. <a href="mailto:" class="email" itemprop="email"></a> <a href="https://twitter.com/RafaellLycan" class="twitter-follow-button" data-show-count="true"></a></div></div></section><a class="next-article " href="/2015/comecando-com-react/" title="Começando com React.js"> <span class="container"> <span class="next-article__heading">Next article:</span> <span class="next-article__title">Começando com React.js</span> <span class="next-article__description">Vamos entender qual é a proposta do React, pra que serve e como começar a utilizar. </span> <button class="btn btn--outline">Read more &rarr;</button> </span> </a><section class="comments container"><h3 class="comments__title">Comments</h3><div id="disqus_thread"></div></section><script type="text/javascript"> var disqus_loaded = false; function load_disqus(){ disqus_loaded = true; var disqus_shortname = 'rafaelllycan'; var disqus_title = ''; var disqus_url = '/2015/entendendo-flux/'; var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); var ldr = document.getElementById('disqus_loader'); }; window.onscroll = function(e) { if ((window.innerHeight + window.scrollY) >= (document.body.offsetHeight - 600)) { if (!disqus_loaded) load_disqus(); } }; </script> </footer></article></main><footer class="footer" role="contentinfo"><div class="footer__content"> <span class="footer__copy">&copy; 2017 - Rafaell Lycan</span> <span class="footer__description">Made with ♥ using <a href="http://jekyllrb.com/">Jekyll</a> - &lt;/&gt; on <a href="https://github.com/rafaell-lycan" title="Hosted on GitHub">GitHub</a> </span><ul class="footer__social default-list"><li> <a href="#"> <i class="fa fa-twitter"></i> <span class="social-text">Twitter</span> </a><li> <a href="#"> <i class="fa fa-linkedin"></i> <span class="social-text">Linkedin</span> </a><li> <a href="#"> <i class="fa fa-github"></i> <span class="social-text">Github</span> </a></ul></div></footer> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-16383035-5', 'auto'); ga('require', 'displayfeatures'); ga('send', 'pageview'); </script> <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js?1493084291212194000"></script> <script async src="https://use.fontawesome.com/81e129060e.js?1493084291212194000"></script>  <script src="/assets/scripts/main.js?1493084291212194000"></script> <script> 'use strict'; WebFont.load({ google: { families: [ 'Merriweather:300,300i,900,900i', 'Open Sans: 400,700', 'Fira Mono: 400', ] } }); // if ('serviceWorker' in navigator && (window.location.protocol === 'https:' || window.location.hostname === 'localhost')) { // navigator.serviceWorker // .register('/sw.js?1493084291212194000') // .then(function(registration){console.log('Service Worker Registered.')}) // .catch(function(error){console.log('Error during service worker registration:', error)}); // } </script>
